<%# Copyright 2011-2012 Rice University. Licensed under the Affero General Public 
    License version 3 or later.  See the COPYRIGHT file for details. %>

<% if @question.errors.empty? %>
   $("#preview_dialog").html("<%= escape_javascript(render :partial => "show", 
                                                   :locals => {:question => @question}) %>");
   <%= reload_mathjax("preview_dialog") %>

   $("#preview_dialog").dialog('open');
   $('.ui-widget-overlay').live("click",function(){
            $("#preview_dialog").dialog("close");
        });    
<% else %>
   // Submit the form so that the error messages display nicely with formatting
   // around the offending entries (use the trigger approach so we don't get
   // the 'are you sure you want to leave' error message)
   $("#save_button").trigger('click');
<% end %>
